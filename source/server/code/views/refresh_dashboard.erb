<script>
'use strict';
$(() => {

  const id = '<%= @group.id %>';

  cd.refreshDashboard = () => {
    const minuteColumns = cd.minuteColumns.isChecked() ? 'true' : 'false';
    $.getJSON(`/dashboard/heartbeat?id=${id}&minute_columns=${minuteColumns}`, {}, (data) => {
      // TODO: empty the table (via its ID)
      updateTimeTicks(data.time_ticks);
      updateAvatars(data.avatars);
    });
  };

  const updateTimeTicks = (timeTicks) => {
    alert(`update time_ticks from: ${JSON.stringify(timeTicks)}`);
  };

  const updateAvatars = (avatars) => {
    // for each avatar...
    //   update avatar-image
    //   update pie-chart
    //   update traffic-light-count
    //   update traffic-lights
  };

});
</script>
